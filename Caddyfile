# Main domain - public-facing Link-in-Bio site
# Replace 'festas-builds.com' with your actual domain
festas-builds.com {
    tls eric@festas-builds.com
    reverse_proxy web:8000
}

# Admin subdomain - administrative interface
# Replace 'festas-builds.com' with your actual domain
admin.festas-builds.com {
    tls eric@festas-builds.com
    reverse_proxy web:8000
}

# RigPilot subdomain - PC Builder application
# The rigpilot container must join the 'caddy-network' external network
rigpilot.festas-builds.com {
    tls eric@festas-builds.com
    encode gzip zstd
    # Cache static Next.js assets with immutable cache headers
    @static path /_next/static/*
    header @static Cache-Control "public, max-age=31536000, immutable"
    reverse_proxy rigpilot:3000
}

# ImmoCalc subdomain - Immobilien Investment Calculator
# The immocalc container must join the 'caddy-network' external network
immocalc.festas-builds.com {
    tls eric@festas-builds.com
    encode gzip zstd
    # Cache static Next.js assets with immutable cache headers
    @static path /_next/static/*
    header @static Cache-Control "public, max-age=31536000, immutable"
    reverse_proxy immocalc:3000
}

# Minecraft Server Website - public landing page for the Minecraft server
# The minecraft-web container must join the 'caddy-network' external network
mc.festas-builds.com {
    tls eric@festas-builds.com
    encode gzip zstd
    
    # Static assets caching for website
    @static path *.css *.js *.png *.jpg *.jpeg *.gif *.ico *.svg *.woff *.woff2
    header @static Cache-Control "public, max-age=31536000, immutable"
    
    # API routes for console backend
    handle /api* {
        reverse_proxy minecraft-console:3001
    }
    
    # Console routes (with WebSocket support for real-time logs)
    handle /console* {
        reverse_proxy minecraft-console:3001
    }
    
    # Socket.io WebSocket connections for real-time features
    handle /socket.io* {
        reverse_proxy minecraft-console:3001
    }
    
    # Everything else goes to the static website
    handle {
        reverse_proxy minecraft-web:80
    }
}

# Cosmic Survivor Game - browser-based space survival game
# The cosmic-survivor container must join the 'caddy-network' external network
cs.festas-builds.com {
    tls eric@festas-builds.com
    encode gzip zstd
    # Cache static game assets with long expiry
    @static path *.css *.js *.png *.jpg *.jpeg *.gif *.ico *.svg *.woff *.woff2 *.mp3 *.ogg *.wav
    header @static Cache-Control "public, max-age=31536000, immutable"
    reverse_proxy cosmic-survivor:80
}
